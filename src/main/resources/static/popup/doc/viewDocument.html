<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <title>ì£¼ë¬¸ ìƒì„¸ ì •ë³´</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background-color: #f8f8f8; }
    .detail-card {
      background: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      padding: 20px; max-width: 600px; margin: auto;
    }

    /* ê¸°ë³¸ ë¦¬ì…‹ */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --primary-color: #4A90E2; /* ERPì˜ ì£¼ìš” ì•¡ì…˜ ìƒ‰ìƒ */
      --secondary-color: #50B86C; /* ë³´ì¡° ìƒ‰ìƒ (ì˜ˆ: ì„±ê³µ) */
      --bg-light: #F8F9FA; /* ë°ì€ ë°°ê²½ */
      --bg-dark: #343A40; /* ì–´ë‘ìš´ ë°°ê²½ (ë„¤ë¹„ê²Œì´ì…˜ ë“±) */
      --text-dark: #333333; /* ë³¸ë¬¸ í…ìŠ¤íŠ¸ */
      --text-light: #FFFFFF; /* ë°ì€ í…ìŠ¤íŠ¸ */
      --border-color: #E0E0E0; /* í…Œë‘ë¦¬ ìƒ‰ìƒ */
      --card-bg: #FFFFFF;
      --nav-h: 64px;
      --sidebar-w: 280px; /* ì‚¬ì´ë“œë°” ë„ˆë¹„ ë³€ìˆ˜ ì¶”ê°€ */
    }

    body {
      font-family: 'Noto Sans KR', sans-serif;
      background-color: var(--bg-light);
      color: var(--text-dark);
      line-height: 1.6;
      min-height: 100vh;
    }


    /* í‘œ ìŠ¤íƒ€ì¼ */
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    th, td {
      border: 1px solid var(--border-color);
      padding: 12px 15px;
      text-align: left;
      font-size: 14px;
    }
    th {
      background-color: var(--bg-light);
      font-weight: 600;
      color: var(--text-dark);
    }
    tr:nth-child(even) {
      background-color: #f9f9f9;
    }
    tr:hover {
      background-color: #f1f1f1;
    }
  </style>
</head>
<body>

<div class="detail-card">
  <h2> ì‚¬ì› ì •ë³´</h2>

  <div id="doc-detail-content">
    ë°ì´í„°ë¥¼ ë¡œë“œí•˜ëŠ” ì¤‘...
  </div>

</div>
<div class="btn-wrap">
  <button type="button" id="btn-approve" value="1" class="submit-btn">
    ìŠ¹ì¸
  </button>
  <button type="button" id="btn-reject" value="2" class="submit-btn">
    ë°˜ë ¤
  </button>
</div>

<script>
  // ìˆ«ì í¬ë§· í•¨ìˆ˜ (hr.jsì— ìˆëŠ” í•¨ìˆ˜ì™€ ë™ì¼)
  function numberFormat(num) {
    if (num === null || num === undefined) return '0';
    return parseInt(num).toLocaleString('ko-KR');
  }

  // URL ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ì—ì„œ salaryId ê°€ì ¸ì˜¤ê¸°


  // API í˜¸ì¶œí•˜ì—¬ ìƒì„¸ ë°ì´í„° ë¡œë“œ
  async function loadDocument() {
    const doc_id = new URLSearchParams(location.search).get('doc_id');
    const contentDiv = document.getElementById('doc-detail-content');

    if (!doc_id) {
      contentDiv.innerHTML=  '<p style="color: red;">ğŸš¨ ì˜¤ë¥˜: ë¬¸ì„œ ë²ˆí˜¸ê°€ ì „ë‹¬ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.</p>';
      return;
    }


    try {
      const document = await $.ajax({
        url: `/api/doc/searchById`,
        method: 'GET',
        date:{
          doc_id: doc_id
        },
        dataType: 'json'
      });

      // ë§Œì•½ í•´ë‹¹ ë¬¸ì„œê°€ ì—†ì–´ì„œ nullì´ë©´ ì²˜ë¦¬
      if (!document) {
        contentDiv.innerHTML =
                '<p style="color:red;">í•´ë‹¹ ë¬¸ì„œ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>';
        return;
      }

      let body;
      contentDiv.innerHTML= body;




    } catch (err) {
      console.error("ë¡œë”© ì‹¤íŒ¨:", err);
      contentDiv.innerHTML = '<p style="color: red;">ğŸš¨ ë°ì´í„° ë¡œë”© ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</p>';
    }
  }

  async function changeStatus() {
    const doc_id = new URLSearchParams(location.search).get('doc_id');
    if (!doc_id) {
      alert('doc_idê°€ ì—†ì–´ ìƒíƒœë¥¼ ë³€ê²½í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
      return;
    }
    const status = this.value;


    try{
      const result = await $.ajax({
        url: '/api/doc/editStatus',
        method: 'POST',
        dataType: 'json',
        data: {
          doc_id: doc_id,
          status: status
        }
      });

      if (result === true || result?.success) {
        alert('ìƒíƒœê°€ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.');
        window.close?.();
      } else {
        alert('ìƒíƒœ ë³€ê²½ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
      }
    }catch(err){
      console.error('ìƒíƒœ ë³€ê²½ ì¤‘ ì˜¤ë¥˜:', err);
      alert('ìƒíƒœ ë³€ê²½ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
    }
  }

  $(document).ready(function(){
    loadDocument();

    // ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
    $('.submit-btn').on('click', changeStatus);
  });
</script>
</body>
</html>