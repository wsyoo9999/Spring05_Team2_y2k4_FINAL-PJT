<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <title>ì„¸ë¡œí˜• ì•„ì½”ë””ì–¸ + 10x10 í‘œ</title>
    <style>
        /* ê¸°ë³¸ ë¦¬ì…‹ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f9;
            padding: 20px;
        }

        /* ì¢Œìš° ë ˆì´ì•„ì›ƒ */
        .erp {
            display: flex;
            gap: 20px;
            align-items: flex-start;
            /* í™”ë©´ì´ ì¢ì•„ì§€ë©´ ì•„ë˜ë¡œ ë–¨ì–´ì§€ë„ë¡ */
            flex-wrap: wrap;
        }

        /* ì™¼ìª½: ì•„ì½”ë””ì–¸ */
        .accordion-container {
            width: 300px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        .accordion-item { border-bottom: 1px solid #ddd; }
        .accordion-header {
            width: 100%;
            padding: 15px;
            text-align: left;
            background-color: #f1f1f1;
            border: none;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        .accordion-header:hover { background-color: #e1e1e1; }
        .accordion-content {
            padding: 15px;
            background-color: #fafafa;
            display: none;
            font-size: 14px;
            color: #333;
        }

        /* ì˜¤ë¥¸ìª½: í‘œ ì˜ì—­ì´ ë‚¨ì€ ê³µê°„ì„ ì°¨ì§€ */
        .results {
            flex: 1 1 400px; /* ìµœì†Œ 400px, ë‚¨ì€ ê³µê°„ì€ ëª¨ë‘ ì°¨ì§€ */
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            padding: 16px;
            overflow: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }
        td, th {
            border: 1px solid #ccc;
            padding: 10px;
            text-align: center;
        }

        .section-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 12px;
        }

        <!-- ë©”ë‰´ë°” -->
        :root {
            --nav-h: 56px;
            --nav-bg: #0f172a;     /* ìŠ¬ë ˆì´íŠ¸-900 ëŠë‚Œ */
            --nav-fg: #e5e7eb;     /* gray-200 */
            --nav-fg-dim: #cbd5e1; /* gray-300 */
            --nav-accent: #60a5fa; /* blue-400 */
        }

        /* ìƒë‹¨ ë°” */
        .nav-bar {
            position: sticky;
            top: 0;
            z-index: 1000;
            height: var(--nav-h);
            background: var(--nav-bg);
            color: var(--nav-fg);
            display: flex;
            align-items: center;
            padding: 0 16px;
            box-shadow: 0 2px 8px rgba(0,0,0,.25);
        }
        .nav-brand {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 700;
            letter-spacing: .2px;
        }
        .nav-brand .nav-logo {
            width: 28px; height: 28px; border-radius: 6px;
            background: linear-gradient(135deg,#3b82f6,#22d3ee);
            display: inline-block;
        }

        .nav-spacer { flex: 1; }

        /* ë§í¬ ì˜ì—­ */
        .nav-links {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .nav-link {
            display: inline-flex;
            align-items: center;
            height: 36px;
            padding: 0 12px;
            border-radius: 8px;
            color: var(--nav-fg-dim);
            text-decoration: none;
            font-size: 14px;
            transition: background .2s, color .2s;
        }
        .nav-link:hover { color: var(--nav-fg); background: rgba(255,255,255,.08); }
        .nav-link.active { color: var(--nav-accent); background: rgba(96,165,250,.12); }

        /* ìš°ì¸¡ ì•„ì´ì½˜ë“¤ */
        .nav-right {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-left: 8px;
        }
        .nav-icon-btn {
            width: 36px; height: 36px;
            border: 0; border-radius: 8px;
            background: transparent;
            color: var(--nav-fg-dim);
            cursor: pointer;
            transition: background .2s, color .2s;
        }
        .nav-icon-btn:hover { color: var(--nav-fg); background: rgba(255,255,255,.08); }



        /* ë³¸ë¬¸ ìƒë‹¨ ì—¬ë°± (ê³ ì •ë°” ë†’ì´ë§Œí¼) */
        body { padding-top: 0; }
    </style>
</head>
<body>
<header class="nav-bar">
    <div class="nav-brand">
        <span class="nav-logo" aria-hidden="true"></span>
        <span>My ERP</span>
    </div>

    <div class="nav-spacer"></div>

    <nav class="nav-links" id="navLinks">
        <a href="#" class="nav-link active" data-topnav="dashboard">ëŒ€ì‹œë³´ë“œ</a>
        <a href="#" class="nav-link" data-topnav="sales">íŒë§¤</a>
        <a href="#" class="nav-link" data-topnav="production">ìƒì‚°</a>
        <a href="#" class="nav-link" data-topnav="inventory">ì¬ê³ </a>
        <a href="#" class="nav-link" data-topnav="reports">ë¦¬í¬íŠ¸</a>
        <a href="#" class="nav-link" data-topnav="settings">ì„¤ì •</a>
    </nav>

    <div class="nav-right">
        <button class="nav-icon-btn" title="ì•Œë¦¼" aria-label="ì•Œë¦¼">ğŸ””</button>
        <button class="nav-icon-btn" title="í”„ë¡œí•„" aria-label="í”„ë¡œí•„">ğŸ‘¤</button>
    </div>
</header>

<div class="erp">
    <!-- ì™¼ìª½: ì•„ì½”ë””ì–¸ -->
    <div class="accordion-container">
        <div class="accordion-item">
            <button class="accordion-header">ì¬ë¬´/íšŒê³„</button>
            <div class="accordion-content">
                <button class="menu" data-file="finance" data-fn = "profit_listAll" data-table="profit">ë§¤ì¶œ</button>
                <button class="menu" data-file="finance" data-fn = "spend_listAll" data-table="spend">ì§€ì¶œ</button>
            </div>
        </div>
        <div class="accordion-item">
            <button class="accordion-header">íŒë§¤/êµ¬ë§¤</button>
            <div class="accordion-content">
                <button class="menu" data-file="transaction" data-fn="sale_listAll" data-table="sale">íŒë§¤</button>
                <button class="menu" data-file="transaction" data-fn="purchase_listAll" data-table="purchase">êµ¬ë§¤</button>
            </div>
        </div>
        <div class="accordion-item">
            <button class="accordion-header">ìƒì‚°/ì œì¡°</button>
            <div class="accordion-content">
                <button class="menu" data-file="production" data-fn="work_order_listAll" data-table="work_order">ì‘ì—… ì§€ì‹œì„œ</button>
                <button class="menu" data-file="production" data-fn="bom_listAll"   data-table="bom">ìì¬ ëª…ì„¸ì„œ</button>
            </div>
        </div>
        <div class="accordion-item">
            <button class="accordion-header" >ì¬ê³ </button>
            <div class="accordion-content">
                <button class="menu" data-file="item" data-fn="items_listAll" data-table="items">ë¬¼í’ˆ ëª©ë¡</button>
                <button class="menu" data-file="item" data-fn="inbound_listAll" data-table="inbound">ì…ê³ </button>
                <button class="menu" data-file="item" data-fn="outbound_listAll" data-table="outbound">ì¶œê³ </button>
            </div>
        </div>
        <div class="accordion-item">
            <button class="accordion-header">ì¸ì‚¬</button>
            <div class="accordion-content">
                <button class="menu" data-file="hr" data-fn="employees_listAll" data-table="employees">ì§ì› ëª©ë¡</button>

                <button class="menu" data-file="hr" data-fn="attendance_listAll" data-table="attendance">ê·¼íƒœ í˜„í™©</button>

                <button class="menu" data-file="hr" data-fn="salary_listAll" data-table="salary">ê¸‰ì—¬ ëŒ€ì¥</button>
            </div>
        </div>
    </div>

    <div class="results">
        <div class="section-title">test</div>
        <div id="search"></div>             <!-- ê²€ìƒ‰ UI ì¶œë ¥ ìœ„ì¹˜-->
        <div id="table"></div>           <!-- DB ê²°ê³¼ ì¶œë ¥ ìœ„ì¹˜-->
    </div>
</div>

<script>
    // ì•„ì½”ë””ì–¸ ë™ì‘
    const accordionHeaders = document.querySelectorAll('.accordion-header');
    accordionHeaders.forEach(header => {
        header.addEventListener('click', function () {
            const content = this.nextElementSibling;
            if (content.style.display === 'block') {
                content.style.display = 'none';
            } else {
                document.querySelectorAll('.accordion-content').forEach(item => {
                    item.style.display = 'none';
                });
                content.style.display = 'block';
            }
        });
    });

</script>
<script type="module">

    const list = document.querySelectorAll('.menu');
    const search = document.getElementById('search');
    const table = document.getElementById('table');

    search.addEventListener('click',searchClick)
    table.addEventListener('click',tableClick)

    async function listClick(e){
        const menu = e.currentTarget;
        const file_name = menu.dataset.file;
        const fn_name = menu.dataset.fn;
        const table_name = menu.dataset.table;

        search.innerHTML = '';
        table.innerHTML = '';

        try{
            const module = await import(`./js/${file_name}.js`);  //í•´ë‹¹ íŒŒì¼ì˜ ëª¨ë“  í•¨ìˆ˜ë“¤ ê°€ì ¸ì˜¤ê¸°

            const search_bar = table_name+'_search_form';
            const buildTable = module[fn_name];//ë²„íŠ¼ì˜ idì™€ ê°™ì€ ì´ë¦„ì˜ í•¨ìˆ˜ ì„¤ì •
            const buildSearch = module[search_bar];

            const tableResult = await buildTable(); //í•¨ìˆ˜ì˜ ë¦¬í„´ê°’ì€ ì™„ì „í•œ htmlì˜ í…Œì´ë¸” êµ¬ì¡°
            const searchUI = await buildSearch();


            table.innerHTML = tableResult;
            search.innerHTML = searchUI;
        }
        catch(err){
            console.error(err);
        }
    }
    list.forEach(btn => {
        btn.addEventListener('click',listClick)
    });

    //===================================================================
    //=======================ìœ„ëŠ” ì•„ì½”ë””ì–¸ ë©”ë‰´ ì´ë²¤íŠ¸============================


    async function searchClick(e){
        const search_btn = e.target.closest('[data-action]');
        if (!search_btn) return;
        if (search_btn.dataset.action!=='search') return;    //search_btnê°’ì´ ì—†ë‹¤ë©´(= ê²€ìƒ‰ë²„íŠ¼ì´ ì•„ë‹Œ ë‹¤ë¥¸ ë¶€ë¶„ì˜ í´ë¦­) ë¬´ì‹œ


        e.preventDefault(); //ìƒˆë¡œê³ ì¹¨ ë°©ì§€

        console.log(search_btn);

        try{

            const file_name = search_btn.dataset.file;  //í˜„ì¬ ê²€ìƒ‰ì´ ì–´ëŠ í…Œì´ë¸” ê²€ìƒ‰ì¸ì§€
            const fn_name = search_btn.dataset.fn;       //ì–´ëŠ í•¨ìˆ˜ë¥¼ ì‹¤í–‰í• ì§€, í™•ì¥ì„ ìœ„í•´ ìƒì„±

            const module = await import(`./js/${file_name}.js`);  //í•´ë‹¹ íŒŒì¼ì˜ ëª¨ë“  í•¨ìˆ˜ë“¤ ê°€ì ¸ì˜¤ê¸°

            const buildTable = module[fn_name];

            const form = search_btn.closest('form');   //<div id="search"></div> ë‚´ì˜ form íƒœê·¸ ê°€ì ¸ì˜´
            const formData = Object.fromEntries(new FormData(form).entries());      //form íƒœê·¸ì˜ ì…ë ¥ê°’ë“¤ì„ iteratorë¡œ ê°€ì ¸ì˜´,ê·¸ë¦¬ê³  ì´ë¥¼ ê°ì²´ë¡œ ë°”ê¿ˆ
            console.log(formData);
            const tableResult = await buildTable(formData); //í•¨ìˆ˜ì˜ ë¦¬í„´ê°’ì€ ì™„ì „í•œ htmlì˜ í…Œì´ë¸” êµ¬ì¡°
            table.innerHTML = tableResult;
        }
        catch(err){
            console.error(err);
        }
    }
    async function tableClick(e){
        const table_event = e.target.closest('[data-action]');
        if (!table_event) return;

        console.log(table_event);
        switch(table_event.dataset.action){
            case 'edit':
                break;
            case 'add':
                await addRecord(table_event);
                break;
            case 'detail':
                await viewDetail(table_event);
                break;
        }


    }
    async function addRecord(e){
        const file_name = e.dataset.file;  //í˜„ì¬ ê²€ìƒ‰ì´ ì–´ëŠ í…Œì´ë¸” ê²€ìƒ‰ì¸ì§€
        const fn_name = e.dataset.fn;       //ì–´ëŠ í•¨ìˆ˜ë¥¼ ì‹¤í–‰í• ì§€, í™•ì¥ì„ ìœ„í•´ ìƒì„±


        try{
            const module = await import(`./js/${file_name}.js`);  //í•´ë‹¹ íŒŒì¼ì˜ ëª¨ë“  í•¨ìˆ˜ë“¤ ê°€ì ¸ì˜¤ê¸°

            const addMenu = module[fn_name];

            addMenu();
        }catch(err){
            console.error(err);
        }

    }

    async function viewDetail(e){
        const file_name = e.dataset.file;  //í˜„ì¬ ê²€ìƒ‰ì´ ì–´ëŠ í…Œì´ë¸” ê²€ìƒ‰ì¸ì§€
        const fn_name = e.dataset.fn;       //ì–´ëŠ í•¨ìˆ˜ë¥¼ ì‹¤í–‰í• ì§€, í™•ì¥ì„ ìœ„í•´ ìƒì„±


        try{
            const module = await import(`./js/${file_name}.js`);  //í•´ë‹¹ íŒŒì¼ì˜ ëª¨ë“  í•¨ìˆ˜ë“¤ ê°€ì ¸ì˜¤ê¸°

            const addMenu = module[fn_name];

            addMenu(e);
        }catch(err){
            console.error(err);
        }
    }


    // í–„ë²„ê±° í† ê¸€
    (function() {
        const navLinks  = document.getElementById('navLinks');

        // ë§í¬ í´ë¦­ ì‹œ í™œì„±í™” í‘œì‹œ + ëª¨ë°”ì¼ì—ì„œ ë‹«ê¸°
        navLinks?.addEventListener('click', (e) => {
            const link = e.target.closest('.nav-link');     //í´ë¦­í•œ ë©”ë‰´ë°”ì—ì„œ ê°€ì¥ ê°€ê¹Œìš´ nav-link í…Œê·¸ ì§€ì •
            if (!link) return;
            // active ê´€ë¦¬
            navLinks.querySelectorAll('.nav-link').forEach(a => a.classList.remove('active'));  //ì¼ë‹¨ ëª¨ë“  ë©”ë‰´ active ì‚­ì œ
            link.classList.add('active');       //í´ë¦­í•œ ë©”ë‰´ë§Œ í™œì„±í™”
        });
    })();

    // (ì„ íƒ) ìƒë‹¨ ë©”ë‰´ â†” ì™¼ìª½ ì•„ì½”ë””ì–¸ ì—°ë™ ì˜ˆì‹œ
    // data-topnav ê°’ê³¼ ì¢Œì¸¡ ë²„íŠ¼ì˜ data-file, data-fn ë“±ì„ ë§¤í•‘í•´ì„œ ìë™ í´ë¦­
    (function() {
        const map = {
            sales:    { file: 'transaction', fn: 'sale_listAll' },
            production: { file: 'production', fn: 'work_order_listAll' },
            item:  { file: 'item', fn: 'items_listAll' },
            reports: null, // ë‚˜ì¤‘ì— êµ¬í˜„
            settings: null
        };

        document.getElementById('navLinks')?.addEventListener('click', (e) => {
            const link = e.target.closest('.nav-link');
            if (!link) return;

            const key = link.dataset.topnav;
            const target = map[key];
            if (!target) return;

            // ì¢Œì¸¡ ì•„ì½”ë””ì–¸ì—ì„œ í•´ë‹¹ ë²„íŠ¼ì„ ì°¾ì•„ í´ë¦­
            const btn = document.querySelector(`.menu[data-file="${target.file}"][data-fn="${target.fn}"]`);
            if (btn) btn.click();
        });
    })();
</script>

</body>
</html>
